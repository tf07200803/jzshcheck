var pukuArray=new Array,colorArray=new Array("♣","♦","♥","♠"),finishArray=new Array,scoreArray=new Array,scoresort=new Array("第一名","第二名","第三名","第四名");function init(){setdata(),share()}function setdata(){for(var r=num=0;r<52;r++)r%13==0&&0!=r&&num++,7<r%13&&pukuArray.push({color:colorArray[num],id:r,paper:r%13+1})}function share(){for(var r=0;r<4;r++){for(var e=new Array,a=0;a<5;a++){var n=Math.floor(Math.random()*pukuArray.length);e.push(pukuArray[n]),pukuArray.splice(n,1)}finishArray.push(e)}showpuku()}function showpuku(){for(var r="",e=JSON.parse(JSON.stringify(finishArray)),a=0;a<finishArray.length;a++){r+='<div class="userDiv">',r+="<ul>";for(var n=0;n<finishArray[a].length;n++)style="black","♥"!=finishArray[a][n].color&&"♦"!=finishArray[a][n].color||(style="red"),showtxt=finishArray[a][n].paper,1==finishArray[a][n].paper?(finishArray[a][n].paper=14,e[a][n].paper=1,showtxt="A"):11==finishArray[a][n].paper?showtxt="J":12==finishArray[a][n].paper?showtxt="Q":13==finishArray[a][n].paper&&(showtxt="K"),r+='<li><div class="number">'+showtxt+'</div><div class="color '+style+'">'+finishArray[a][n].color+"</div></li>";r+="</ul>",r+='<div class="answer">';var t=checkpuku(finishArray[a],e[a]);scoreArray.push({id:a,score:t.winner}),r+=t.type,r+="</div>",r+='<div class="winner'+a+'"></div>',r+="</div>"}scoreArray.sort(function(r,e){return e.score-r.score}),$txt=$(r);for(a=0;a<scoreArray.length;a++)$txt.find(".winner"+scoreArray[a].id).text(scoresort[a]);$(".container").append($txt)}function checkpuku(r,e){r.sort(function(r,e){return r.paper-e.paper}),e.sort(function(r,e){return r.paper-e.paper});for(var a=[],n=[],t=[],s=[],p=0;p<r.length;p++)-1!=jQuery.inArray(r[p].paper,a)?a.push("s"):a.push(r[p].paper),0!=p?(r[p].color==r[p-1].color&&n.push(r[p].paper),r[p].paper==r[p-1].paper+1&&t.push(r[p].paper),e[p].paper==e[p-1].paper+1&&s.push(e[p].paper)):(n.push(r[p].paper),t.push(r[p].paper),s.push(e[p].paper));var o=[];for(p=0;p<a.length;p++)"s"==a[p]&&(a[p]=a[p-1],o.push(a[p-1]));var i=0,h=collectionRepeat(o),u=Object.entries(h),l="散牌";if(0<u.length&&u.length<2&&1==u[0][1]){l="對子",other=[];for(p=0;p<a.length;p++)-1==jQuery.inArray(a[p],o)&&other.push(a[p]);i+=1e3*parseInt(u[0][0])+rema(other)}else if(0<u.length&&u.length<2&&2==u[0][1])l="三條",i=2e5,i+=1e3*parseInt(u[0][0]);else if(0<u.length&&u.length<2&&3==u[0][1])l="鐵支",i=7e5,i+=1e3*parseInt(u[0][0]);else if(1<u.length&&1==u[0][1]&&1==u[1][1]){l="對對",i=1e5,other=[];for(p=0;p<a.length;p++)-1==jQuery.inArray(a[p],o)&&other.push(a[p]);parseInt(u[0][0])>parseInt(u[1][0])?i+=1e3*parseInt(u[0][0])+100*parseInt(u[1][0])+rema(other):i+=1e3*parseInt(u[1][0])+100*parseInt(u[0][0])+rema(other)}else 1<u.length&&2==u[0][1]&&1==u[1][1]?(l="葫蘆",i=6e5,i+=1e3*parseInt(u[0][0])):1<u.length&&1==u[0][1]&&2==u[1][1]?(l="葫蘆",i=6e5,i+=1e3*parseInt(u[1][0])):5==n.length?(l="同花",i=4e5+rema(n),5!=t.length&&5!=s.length||(l="同花順",i+=6e5)):5!=t.length&&5!=s.length||(l="順子",i=3e5+rema(t));return{type:l,winner:i}}var collectionRepeat=function(r,e){var a={};r.forEach(function(r){a[r]=(a[r]||0)+1});var n=a[e];return void 0===e?a:void 0===n?0:n};function rema(r){var e=0;return r[0]&&(e+=1*r[0]),r[1]&&(e+=50*r[1]),r[2]&&(e+=100*r[2]),r[3]&&(e+=500*r[3]),r[4]&&(e+=1e3*r[4]),e}function btnclick(){window.location.reload()}